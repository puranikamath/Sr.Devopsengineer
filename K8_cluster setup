Follow steps: Master Node/ Workernode1/ Workernode2
Kubernetes Installation Steps: 
Step1: Install Containers 
(Run on both Master and Worker Nodes) 

1.sudo apt update 

2.sudo swapoff -a 

3.sudo sed -i  '/ swap / s/^\(.*\)$/#\1/g' /etc/fstab 

4.sudo tee /etc/modules-load.d/containerd.conf <<EOF 
overlay 
br_netfilter 
EOF

5.sudo modprobe overlay 

6.sudo modprobe br_netfilter 

7.
sudo tee /etc/sysctl.d/kubernetes.conf <<EOF 
net.bridge.bridge-nf-call-ip6tables = 1 
net.bridge.bridge-nf-call-iptables = 1 
net.ipv4.ip_forward = 1 
EOF 

8.sudo sysctl --system 

9.sudo apt install ca-certificates curl gnupg lsb-release 

10. sudo mkdir -p /etc/apt/keyrings 

11. curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg 

12. echo "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null  

13.sudo apt update && sudo apt install -y containerd.io 

14.containerd config default | sudo tee /etc/containerd/config.toml >/dev/null 2>&1 

ï»¿15.sudo sed -i 's/SystemdCgroup \= false/SystemdCgroup \= true/g' /etc/containerd/config.toml 

16.sudo systemctl restart containerd 

17.sudo systemctl enable containerd 

Follow steps: Master Node/ Workernode1/ Workernode2
Step2: Install Kubectl, kubeadm,kubelet 
(Run on both  Master and Worker Nodes) 
Run in Root Account

1.sudo apt-get update 

2.sudo apt-get install -y apt-transport-https ca-certificates curl gpg 

3.
curl -fsSL https://pkgs.k8s.io/core:/stable:/v1.30/deb/Release.key | gpg --dearmor -o /etc/apt/keyrings/kubernetes-apt-keyring.gpg

4. 
echo 'deb [signed-by=/etc/apt/keyrings/kubernetes-apt-keyring.gpg] https://pkgs.k8s.io/core:/stable:/v1.30/deb/ /' | tee /etc/apt/sources.list.d/kubernetes.list

5.sudo apt-get update 

6.sudo apt-get install -y kubelet kubeadm kubectl 

7.sudo apt-mark hold kubelet kubeadm kubectl 

8.sudo systemctl enable --now kubelet 

>>>>>>>>>>>>>>>>>>>>>>>>>>>
Step3: Only on Master Node 

1.kubeadm init --pod-network-cidr=10.244.0.0/16
After Kube init you will get kubeadm join command, copy it and save - this is unique - this is needed later
kubeadm join 172.31.12.83:6443 --token c4p4o9.wka20bm8zobf0cti \
        --discovery-token-ca-cert-hash sha256:146841827f6abc8f428b6d9e814ef517315b88403e81c1f293e322cf8bfabd34

<<<<<<mine servr adm join>>>>> kubeadm join 172.31.44.134:6443 --token wwssa4.hzxv8e5yt8rri4up \
        --discovery-token-ca-cert-hash sha256:8a443a367c4322a4560a4d1ff9f697406ad1bff6f7d428fce1a1350bedc805e1 

2.mkdir -p $HOME/.kube 

3.sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config 

4.sudo chown $(id -u):$(id -g) $HOME/.kube/config 

5.export KUBECONFIG=/etc/kubernetes/admin.conf 

6. kubectl apply -f https://docs.projectcalico.org/manifests/calico.yaml 
Enable PORTs in All EC2 instances - all traffic both inbound and outbound

NOTE:

Step4: You can now join any number of machines by running the following on each node as root: 
Only on Worker Nodes:
This is the command you copied above in the kubeadm init command 
kubeadm join <control-plane-host>:<control-plane- 
port> --token <token> --discovery-token-ca-cert-hash  
sha256:<hash> 

Ex:
kubeadm join 172.31.12.83:6443 --token c4p4o9.wka20bm8zobf0cti \
        --discovery-token-ca-cert-hash sha256:146841827f6abc8f428b6d9e814ef517315b88403e81c1f293e322cf8bfabd34

To Check Connection is Successful:
kubectl get pods -A
kubectl get nodes
kubectl get pods -A -owide #owide option displays ip address 
kubectl get nodes -owide 
